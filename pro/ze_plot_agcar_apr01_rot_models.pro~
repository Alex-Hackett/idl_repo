Angstrom = '!6!sA!r!u!9 %!6!n'
close,/all

;defining observations
obs01apr='/aux/pc244a/jgroh/espectros/agcar/agc01apr12_4088nsyss.txt'



;defining models
;model223narv='/aux/pc244a/jgroh/espectros/agcar/223_narv2.txt'
;model362narv='/aux/pc244a/jgroh/espectros/agcar/362_narv2.txt'  
;model348narv='/aux/pc244a/jgroh/espectros/agcar/348_cpnv_optn.txt'
;model363narv='/aux/pc244a/jgroh/espectros/agcar/363_narv2.txt'  
;model358narv='/aux/pc244a/jgroh/espectros/agcar/358_narv2.txt'
model372narv='/aux/pc244a/jgroh/espectros/agcar/372_optn.txt'
model3722da='/aux/pc244a/jgroh/espectros/agcar/372_2da.txt'
model3722db='/aux/pc244a/jgroh/espectros/agcar/372_2db.txt'
model3722dc='/aux/pc244a/jgroh/espectros/agcar/372_2dc.txt'
model3722dd='/aux/pc244a/jgroh/espectros/agcar/372_2dd.txt'
model3722de='/aux/pc244a/jgroh/espectros/agcar/372_2de.txt'
;model3722df='/aux/pc244a/jgroh/espectros/agcar/372_2df.txt'


;reading observations
;ZE_READ_SPECTRA_COL_VEC, obs86jun1,lambda86jun1,flux86jun1
;ZE_READ_SPECTRA_COL_VEC, obs87jan1,lambda87jan1,flux87jan1
;ZE_READ_SPECTRA_COL_VEC, obs87jan2,lambda87jan2,flux87jan2
;ZE_READ_SPECTRA_COL_VEC, obs87jun1,lambda87jun1,flux87jun1
;ZE_READ_SPECTRA_COL_VEC, obs87jun2,lambda87jun2,flux87jun2
;ZE_READ_SPECTRA_COL_VEC, obs89mar1,lambda89mar1,flux89mar1
;ZE_READ_SPECTRA_COL_VEC, obs01apr,lambda01apr,flux01apr

;reading models
;ZE_READ_SPECTRA_COL_VEC,model372narv,l372narv,f372narv
;ZE_READ_SPECTRA_COL_VEC,model3722da,l3722da,f3722da
;ZE_READ_SPECTRA_COL_VEC,model3722db,l3722db,f3722db
;ZE_READ_SPECTRA_COL_VEC,model3722dc,l3722dc,f3722dc
;ZE_READ_SPECTRA_COL_VEC,model3722dd,l3722dd,f3722dd
ZE_READ_SPECTRA_COL_VEC,model3722de,l3722de,f3722de
;ZE_READ_SPECTRA_COL_VEC,model3722df,l3722df,f3722df



;defines ewdata for reading, as generated by CMF_FLUX (including header)
;ewdata_file='/aux/pc244a/jgroh/espectros/agcar/ewdata_fin_271ed'  
ewdata_file='/aux/pc20117a/jgroh/cmfgen_models/agcar/362/obscont/EWDATA'

;convolve data to the obs resolution.

lambda_val=4088.
res01apr=0.081

f372cnvl=ZE_SPEC_CNVL(l372narv,f372narv,res01apr,lambda_val)
f372acnvl=ZE_SPEC_CNVL(l3722da,f3722da,res01apr,lambda_val)
f372bcnvl=ZE_SPEC_CNVL(l3722db,f3722db,res01apr,lambda_val)
f372ccnvl=ZE_SPEC_CNVL(l3722dc,f3722dc,res01apr,lambda_val)
f372dcnvl=ZE_SPEC_CNVL(l3722dd,f3722dd,res01apr,lambda_val)
f372ecnvl=ZE_SPEC_CNVL(l3722de,f3722de,res01apr,lambda_val)

lambda_val=4686.
res01apr=0.081


;f372fcnvl=ZE_SPEC_CNVL(l3722df,f3722df,resmar89,lambda_val)

;scaling Si IV 4088 to match obs EW

f372acnvl=((f372acnvl-1.0)*2.3) +1.0
f372bcnvl=((f372bcnvl-1.0)*2.5) +1.0
f372ccnvl=((f372ccnvl-1.0)*2.2) +1.0


set_plot,'x'

x1l=4080. & x1u=4100.
x2l=4300. & x2u=4820.

;1st panel
window,0
plot,lambda01apr,flux01apr,xstyle=1,ystyle=1,xrange=[x1l,x1u],yrange=[0.6,1.2],xtitle=TEXTOIDL('\lambda')+' ['+Angstrom+']', $
ytitle='F/F!Ic',/nodata,charsize=2,XMARGIN=[8,3];,POSITION=[0.05,0.30,0.985,0.49]
plots,lambda01apr,flux01apr,color=fsc_color('white'),noclip=0,clip=[x1l,0,x1u,13],thick=1
plots,l372narv,f372cnvl,color=fsc_color('red'), noclip=0,clip=[x1l,0,x1u,13],linestyle=0,thick=1
plots,l3722da,f372acnvl,color=fsc_color('blue'), noclip=0,clip=[x1l,0,x1u,13],linestyle=0,thick=1
plots,l3722db,f372bcnvl,color=fsc_color('green'), noclip=0,clip=[x1l,0,x1u,13],linestyle=0,thick=1
plots,l3722dc,f372ccnvl,color=fsc_color('orange'), noclip=0,clip=[x1l,0,x1u,13],linestyle=0,thick=1
xyouts,4000,2.2,'89mar',alignment=0.0,orientation=0

END
